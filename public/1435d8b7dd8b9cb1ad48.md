---
title: ãã¡ã‚“ã¨ç†è§£ã™ã‚‹ Graph Convolution Networks (2)
tags:
  - ä¿¡å·å‡¦ç†
  - æ·±å±¤å­¦ç¿’
  - GCN
  - ã‚°ãƒ©ãƒ•ãƒã‚¤ãƒ‹ãƒ³ã‚°
private: false
updated_at: '2023-12-07T00:53:53+09:00'
id: 1435d8b7dd8b9cb1ad48
organization_url_name: null
slide: false
ignorePublish: false
---
## ç›®æ¬¡
[å‰ã®è¨˜äº‹](https://qiita.com/snoo_py/items/d9ecefbc186ac46a67f3)ã§æ‰±ã£ãŸå†…å®¹
1.ã‚°ãƒ©ãƒ•æ·±å±¤å­¦ç¿’ã¨ã¯
2.ã‚°ãƒ©ãƒ•æ·±å±¤å­¦ç¿’ãŒã§ãã‚‹ã“ã¨
3.ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã‚’ç†è§£ã™ã‚‹

ã“ã®è¨˜äº‹ã§æ‰±ã†å†…å®¹
[4.ã‚°ãƒ©ãƒ•ä¿¡å·ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°](#4-ã‚°ãƒ©ãƒ•ä¿¡å·ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°)
[5.GCN](#5-GCN)
[6.çµ‚ã‚ã‚Šã«](#6-çµ‚ã‚ã‚Šã«)



# 4. ã‚°ãƒ©ãƒ•ä¿¡å·ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã«ã‚ˆã£ã¦ï¼Œã‚°ãƒ©ãƒ•ä¿¡å·ã‚’å‘¨æ³¢æ•°é ˜åŸŸã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼
ã§ã¯ï¼Œ3.1.2ã®ã‚ˆã†ã«å‘¨æ³¢æ•°é ˜åŸŸã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

# 4.1 ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®ä¾‹
å‰ã®è¨˜äº‹ã®ä¾‹1ã®å›³ã‚’ã‚‚ã†ä¸€åº¦è¼‰ã›ã¾ã™ï¼
<img width="600" alt="GFT1.png" src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3583007/c64917f6-8a77-3b06-d235-032480510070.png>

ã“ã®ã‚°ãƒ©ãƒ•ä¿¡å·ã«ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
ã‚°ãƒ©ãƒ•å‘¨æ³¢æ•°ãŒ3ã‚ˆã‚Šå¤§ãã„ã¨ã“ã‚ã®æˆåˆ†ã‚’0ï¼Œï¼Œã¤ã¾ã‚Š$F(\lambda_4)=F(\lambda_5)=0$ã¨ã—ã¾ã™ï¼
ãã®å¾Œï¼Œé€†ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã«ã‚ˆã£ã¦ã‚°ãƒ©ãƒ•ä¿¡å·ã‚’å†æ§‹æˆã—ã¾ã™ï¼
$$
f(k) = \sum_{i=0}^{N-1} {F}(\lambda_i) \cdot u_{\lambda_i}(k)
$$

é«˜å‘¨æ³¢æˆåˆ†ã‚’å–ã‚Šé™¤ã„ãŸã“ã¨ã§ï¼Œãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ã™ã‚‹å‰ã«æ¯”ã¹ï¼Œã‚°ãƒ©ãƒ•ãŒæ»‘ã‚‰ã‹ã«ãªã£ãŸã®ãŒã‚ã‹ã‚Šã¾ã™ã­ï¼
<img width="600" alt="IGFT1.png" src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3583007/22d1ae25-4835-687f-bb6b-c12fd411255e.png>

## 4.2 ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã®è¡Œåˆ—è¡¨è¨˜
ä»Šå¾Œã®ãŸã‚ã«ï¼Œã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã‚’è¡Œåˆ—ã§è¡¨è¨˜ã—ã¾ã™ï¼
ã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³$L$ã®å›ºæœ‰å€¤åˆ†è§£
$$
L = U\Lambda U^T
$$
ãŸã ã—ï¼Œ
$$
U = [u_1,u_2,...,u_N]ï¼Œ \Lambda=diag([\lambda_1,\lambda_2,...,\lambda_N])
$$
ã§ã™

ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›

$$
{F}(\lambda_i) = \sum_{k=0}^{N-1} f(k) \cdot u_{\lambda_i} (k) 
$$
ã¯è¡Œåˆ—ã§æ›¸ãã¨ï¼Œ
$$
F = U^Tf
$$

ãƒ¡ãƒ¢ï¼š$u_{\lambda_i}$ã¯$U$ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ãªã®ã§ï¼Œè¡Œåˆ—ã§ã¾ã¨ã‚ã¦è¨ˆç®—ã™ã‚‹éš›ã¯$U^Tf$ã¨ãªãƒªã¾ã™ï¼

é€†ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›

$$
f(k) = \sum_{i=0}^{N-1} {F}(\lambda_i) \cdot u_{\lambda_i}(k)
$$
ã¯è¡Œåˆ—ã§æ›¸ãã¨ï¼Œ
$$
f = UF
$$
ã¨ãªã‚Šã¾ã™ï¼

æ¬¡ã«ï¼Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®æ“ä½œã‚’è¡Œåˆ—ã§è¡¨ã™ã“ã¨ã‚’è€ƒãˆã¾ã™ï¼1,2,3ã®ã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†ã‘ã¦èª¬æ˜ã—ã¾ã™ï¼

1.ã‚°ãƒ©ãƒ•ä¿¡å·ã‚’å‘¨æ³¢æ•°é ˜åŸŸã«å¤‰æ›
$$
F = U^Tf
$$
2.å‘¨æ³¢æ•°é ˜åŸŸã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã©ã®å‡¦ç†ã‚’è¡Œã†ï¼
ã€€ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã¨å‘¼ã°ã‚Œã‚‹ä»¥ä¸‹ã®è¡Œåˆ—ã‚’Fã«å·¦ã‹ã‚‰æ›ã‘ã‚‹ã“ã¨ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ï¼
ã€€å„å‘¨æ³¢æ•°ã®æˆåˆ†ã«å¯¾ã—ã¦å‡¦ç†ã‚’ã™ã‚‹ã ã‘ã§ã™ï¼
```math
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1) & 0 & \ldots & 0 \\\
0 & H(\lambda_2) & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & H(\lambda_N)
\end{array}
\right)
\end{eqnarray}
```

```math
F_{filtered} = 
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1) & 0 & \ldots & 0 \\\
0 & H(\lambda_2) & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & H(\lambda_N)
\end{array}
\right)
\end{eqnarray}
F
```

ã€€å…ˆã»ã©ã®3.3.3ã®ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ã§ã¯ï¼Œ$F(\lambda_4)=F(\lambda_5)=0$ã¨ã—ã¾ã—ãŸãŒï¼Œã“ã‚Œã‚’ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã§è¡¨ç¾ã™ã‚‹ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
```math
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1)=1 & 0 & 0 & 0  & 0\\\
0 & H(\lambda_2)=1 & 0 & 0  & 0\\\
0 & 0 & H(\lambda_3)=1 & 0  & 0\\\
0  & 0 & 0 & H(\lambda_4)=0  & 0\\\
0  & 0 & 0 & 0 & H(\lambda_5)=0
\end{array}
\right)
\end{eqnarray}
```

3.é€†ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å†æ§‹æˆã‚’è¡Œã†
$$
f_{filtered} = UF_{filtered}
$$

ä»¥ä¸Šã®1,2,3ã‚’ã¾ã¨ã‚ã‚‹ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã“ã¨ãŒã§ãã¾ã™ï¼

```math
f_{filtered} = U 
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1) & 0 & \ldots & 0 \\\
0 & H(\lambda_2) & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & H(\lambda_N)
\end{array}
\right)
\end{eqnarray}
U^Tf
```

ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®æµã‚Œã‚’å›³ã«ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
<img width="700" alt="IGFT1.png" src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3583007/5201c146-9e64-c760-c471-7130c10c2c1a.png>

ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã®æ™‚ã¨ã‚„ã£ã¦ã‚‹ã“ã¨ã¯åŒã˜ã§ã™.3.1.2ã®å›³ã‚’å†æ²ã—ã¾ã™ï¼
<img width="700" alt="image.png" src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3583007/28f14b5a-6e78-5f1c-a4db-d35195ee2d4f.png>


## 4.3 æ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã®æœ€é©åŒ–
[Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering](https://arxiv.org/abs/1606.09375)
å¾Œã»ã©è©³ã—ãç´¹ä»‹ã—ã¾ã™ãŒï¼Œã“ã®è«–æ–‡ã‚’å‚è€ƒã«ã—ã¾ã—ãŸï¼Œ

### 4.3.1 ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–
ã‚°ãƒ©ãƒ•ä¿¡å·ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã«ã¤ã„ã¦ã‚‚ã†å°‘ã—è€ƒãˆã¦ã¿ã¾ã™ï¼
```math
f_{filtered} = U 
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1) & 0 & \ldots & 0 \\\
0 & H(\lambda_2) & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & H(\lambda_N)
\end{array}
\right)
\end{eqnarray}
U^Tf
```

ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«$diag([H(\lambda_1),H(\lambda_2)...,H(\lambda_n)])$ã‚’è‰¯ã„æ„Ÿã˜ã«è¨­è¨ˆã™ã‚Œã°è‰¯ã„æ„Ÿã˜ã®$f_{filtered}$ãŒå¾—ã‚‰ã‚Œãã†ã§ã™ï¼

ä¾‹ãˆã°ï¼Œä½å‘¨æ³¢æˆåˆ†ãŒé‡è¦ã ï¼ã¨ãªã‚Œã°ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ã‚’ã‹ã‘ã‚Œã°è‰¯ã„ã§ã™ã—ï¼Œé€†ã«é«˜å‘¨æ³¢æˆåˆ†ãŒé‡è¦ã ï¼ã¨ãªã‚Œã°ãƒã‚¤ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ã‚’æ›ã‘ã‚Œã°è‰¯ã„ã§ã™ï¼

ä¾‹ãˆã°ï¼Œ$H(\lambda_i)=\frac{1}{\lambda_i+1}$ï¼Œã¤ã¾ã‚Š
```math
\begin{eqnarray}
\left(
\begin{array}{cccc}
H(\lambda_1)=\frac{1}{\lambda_1+1} & 0 & \ldots & 0 \\\
0 & H(\lambda_2)=\frac{1}{\lambda_2+1} & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & H(\lambda_N)=\frac{1}{\lambda_N+1}
\end{array}
\right)
\end{eqnarray}
```
ãªã©ã¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ã“ã®å ´åˆã¯ï¼Œ$\lambda_i$ãŒå¤§ãã„ã»ã©$H(\lambda_i)$ãŒå°ã•ããªã‚‹ã®ã§ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ã«ãªã‚Šã¾ã™ï¼

è©¦è¡ŒéŒ¯èª¤ã—ã¦è‰¯ã„æ„Ÿã˜ã®ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ã§ã‚‚ãã‚Œã¯å¤§å¤‰ãã†ã§ã™ã­...

ã—ã‹ã—ï¼Œ**æ·±å±¤å­¦ç¿’ã‚’ç”¨ã„ã‚Œã°äººæ‰‹ã§è¨­è¨ˆã›ãšã¨ã‚‚ï¼Œæœ€é©ãªãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™ï¼**

ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æœ€é©åŒ–ã™ã‚Œã°è‰¯ã„ã®ã§ã™ï¼
ä¾‹ãˆã°ï¼Œåˆ†é¡ã‚¿ã‚¹ã‚¯ãªã‚‰ã‚¯ãƒ­ã‚¹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãƒ­ã‚¹ã‚’ä½¿ç”¨ã—ã¦ï¼Œãƒ­ã‚¹ã‚’é€†ä¼æ¬ã•ã›ã‚Œã°è‰¯ã„ã§ã—ã‚‡ã†ï¼
ï¼ˆèª¤å·®é€†ä¼æ¬æ³•ã‚„ãƒ­ã‚¹é–¢æ•°ã®è¨­è¨ˆã¯ã“ã“ã§ã¯æ·±ãèª¬æ˜ã—ã¾ã›ã‚“ï¼ï¼‰
```math
f_{filtered} = U 
\begin{eqnarray}
\left(
\begin{array}{cccc}
\theta_1 & 0 & \ldots & 0 \\\
0 & \theta_2 & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & \theta_N
\end{array}
\right)
\end{eqnarray}
U^Tf
```

ç°¡ç•¥åŒ–ã—ã¦ï¼Œä»Šå¾Œã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¾ã™ï¼
```math
f_{filtered} = Ug_Î¸(Î›)U^Tf
```
ä»Šã®å ´åˆã¯ï¼Œ$g_Î¸(Î›)=diag([\theta_1,\theta_2...,\theta_N])$ã¨æ›¸ã‘ã¾ã™ï¼

ã“ã“ã§å•é¡Œç‚¹ãŒã‚ã‚Šã¾ã™ï¼
ã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§ã¯ï¼Œã‚°ãƒ©ãƒ•å…¨ä½“ã®æƒ…å ±ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ï¼Œãƒãƒ¼ãƒ‰$i$ã‹ã‚‰ã¿ãŸæ™‚ï¼Œãƒãƒ¼ãƒ‰$j$ãŒéš£ã«ã‚ã£ã¦ã‚‚é ã„ã¨ã“ã‚ã«ã‚ã£ã¦ã‚‚ä¸€ç·’ã§ã™ï¼
ã¤ã¾ã‚Šï¼Œ**è¿‘ãã«ã©ã®ã‚ˆã†ãªä¿¡å·ãŒã‚ã‚‹ã‹ã¯è¦‹ã¦ã„ãªã„**ã®ã§ã™ï¼

ã¨ã„ã†ã“ã¨ã§ï¼Œè¿‘å‚ã®æƒ…å ±ã‚’æ´»ç”¨ã™ã‚‹ã‚ˆã†ã«ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«$g_Î¸(Î›)$ã‚’è¨­è¨ˆã—ã¾ã—ã‚‡ã†ï¼


### 4.3.2 å¤šé …å¼ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«

ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­è¨ˆã—ã¾ã™ï¼
$$
g_Î¸(\Lambda) = \sum_{k=0}^{K-1}\theta_k\Lambda^{k}
$$

K=3ã®å ´åˆï¼Œ
$$
g_Î¸(\Lambda) = \theta_0\Lambda^{0} + \theta_1\Lambda^{1} + \theta_2\Lambda^{2}
$$
$\Lambda=diag([\lambda_1,\lambda_2,...,\lambda_n])$ãªã®ã§ï¼Œ

```math
g_Î¸(\Lambda) = \theta_0
\begin{eqnarray}
\left(
\begin{array}{cccc}
\lambda_1^0 & 0 & \ldots & 0 \\\
0 & \lambda_2^0 & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & \lambda_N^0\\\
\end{array}
\right)

+

\theta_1\left(
\begin{array}{cccc}
\lambda_1^1 & 0 & \ldots & 0 \\\
0 & \lambda_2^1 & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & \lambda_N^1\\\
\end{array}
\right)

+

\theta_2\left(
\begin{array}{cccc}
\lambda_1^2 & 0 & \ldots & 0 \\\
0 & \lambda_2^2 & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & \ldots & \lambda_N^2\\\
\end{array}
\right)

\end{eqnarray}
```

å…¨ã¦è¶³ã™ã¨ï¼Œ
```math
g_Î¸(\Lambda) =
\begin{eqnarray}
\left(
\begin{array}{cccc}
\theta_0\lambda_1^0  + \theta_1\lambda_1^1 + \theta_2\lambda_1^2 & 0 & \ldots & 0 \\\
0 & \theta_0\lambda_2^0  + \theta_1\lambda_2^1 + \theta_2\lambda_2^2  & \ldots & 0 \\\
\vdots & \vdots & \ddots & \vdots \\\
0 & 0 & ... & \theta_0\lambda_N^0  + \theta_1\lambda_N^1 + \theta_2\lambda_N^2 \\\
\end{array}
\right)
\end{eqnarray}
```


ãƒ»$\Lambda^0$ãŒ0æ¬¡è¿‘å‚ï¼Œã¤ã¾ã‚Šè‡ªåˆ†è‡ªèº«
ãƒ»$\Lambda^1$ãŒ1æ¬¡è¿‘å‚ï¼Œã¤ã¾ã‚Š1hopå…ˆã®ãƒãƒ¼ãƒ‰
ãƒ»$\Lambda^2$ãŒ1æ¬¡è¿‘å‚ï¼Œã¤ã¾ã‚Š2hopå…ˆã®ãƒãƒ¼ãƒ‰
ä¸€èˆ¬ã«ï¼Œ$\Lambda^k$ãŒkæ¬¡è¿‘å‚ã®ãƒãƒ¼ãƒ‰ã‹ã‚‰æƒ…å ±ã‚’é›†ç´„ã™ã‚‹ã“ã¨ã«ç¹‹ãŒã‚‹ãã†ã§ã™ï¼
ï¼ˆã“ã®ç†ç”±ãŒã‚ã‹ã£ã¦ã„ã¾ã›ã‚“ï¼è©³ã—ãã¯ [Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering](https://arxiv.org/abs/1606.09375) ã®(3)å¼ã‚’è¦‹ã¦ãã ã•ã„...ï¼‰

$$
g_Î¸(\Lambda) = \theta_0\Lambda^{0} + \theta_1\Lambda^{1} + \theta_2\Lambda^{2}
$$
ã«ãŠã„ã¦ï¼Œ
ãƒ»$\theta_0$ã¯0æ¬¡è¿‘å‚ï¼ˆï¼è‡ªåˆ†è‡ªèº«ï¼‰ã®æƒ…å ±ã‚’ã©ã®ãã‚‰ã„ä½¿ã†ã‹
ãƒ»$\theta_1$ã¯1æ¬¡è¿‘å‚ã®æƒ…å ±ã‚’ã©ã®ãã‚‰ã„ä½¿ã†ã‹
ãƒ»$\theta_2$ã¯2æ¬¡è¿‘å‚ã®æƒ…å ±ã‚’ã©ã®ãã‚‰ã„ä½¿ã†ã‹
ä¸€èˆ¬ã«ï¼Œ$\theta_k$ã¯kæ¬¡è¿‘å‚ã®æƒ…å ±ã‚’ã©ã®ãã‚‰ã„ä½¿ã†ã‹ã‚’è¡¨ã—ã¾ã™ï¼

ä¾‹ãˆã°ï¼Œãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã®æœ€é©åŒ–ã®çµæœãŒï¼Œ
$$
\theta_0=0.3, \theta_0=0.5, \theta_0=0.1,
$$
ã¨ãªã‚Œã°ï¼Œé‡è¦åº¦ã¯ 1æ¬¡è¿‘å‚ï¼0æ¬¡è¿‘å‚ï¼2æ¬¡è¿‘å‚ ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ï¼

ãŸã ï¼Œã“ã®å¤šé …å¼ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã«ã‚‚å•é¡ŒãŒã‚ã‚Šã¾ã™ï¼
ãã®å•é¡ŒãŒ**è¨ˆç®—é‡**ã§ã™ï¼

ã¾ãšã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³$L$ã®å›ºæœ‰å€¤åˆ†è§£ã«$O(N^3)$ã®è¨ˆç®—ãŒå¿…è¦ã§ã™ï¼
ãã—ã¦ï¼Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®è¡Œåˆ—æ¼”ç®—ã¯$O(N^2)$ã®è¨ˆç®—é‡ã§ã‚ã‚‹ãŸã‚ï¼Œå¤§ããªãƒ‡ãƒ¼ã‚¿ã§ã¯ã‚‚ã®ã™ã”ãæ™‚é–“ãŒã‹ã‹ã£ã¦ã—ã¾ã„ã¾ã™ï¼
å›ºæœ‰å€¤åˆ†è§£ã¯1å›ã ã‘ã§è‰¯ã„ã§ã™ãŒï¼Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¯ã‚¨ãƒãƒƒã‚¯ã”ã¨ã«æ¯å›è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼
ãƒãƒ¼ãƒ‰æ•°ãŒ100ãã‚‰ã„ãªã‚‰å¤§ä¸ˆå¤«ã§ã™ãŒï¼Œæ•°ä¸‡ï¼Œæ•°åä¸‡ã¨ã‚‚ãªã‚‹ã¨ã¾ã¨ã‚‚ã«å‹•ã‹ãªã„ã§ã—ã‚‡ã†ï¼


### 4.3.3 ChebNetï¼ˆãƒã‚§ãƒ“ã‚·ã‚§ãƒ•ã®å¤šé …å¼ã«ã‚ˆã‚‹å¤šé …å¼ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã®è¿‘ä¼¼ï¼‰
å¤šé …å¼ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã«ãŠã‘ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®è¨ˆç®—é‡ã‚’$O(K|\mathcal{E}|)$ã«æ¸›ã‚‰ã™æ‰‹æ³•ãŒã‚ã‚Šã¾ã™ï¼
$K$ã¯è¿‘å‚ã®$K$ã§ï¼Œ$|\mathcal{E}|$ã¯ã‚¨ãƒƒã‚¸ã®æœ¬æ•°ã§ã™ï¼å¤šãã®ã‚°ãƒ©ãƒ•ã§ã¯ï¼Œ$N^2 > K|E|$ã§ã‚ã‚‹ãŸã‚è¨ˆç®—é‡ã®å‰Šæ¸›ã«ç¹‹ãŒã‚Šã¾ã™ï¼

ãã®æ‰‹æ³•ã‚’ææ¡ˆã—ã¦ã„ã‚‹è«–æ–‡ãŒå…ˆã»ã©ã‚‚ç´¹ä»‹ã—ãŸï¼Œ [Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering](https://arxiv.org/abs/1606.09375) ã§ã™ï¼ï¼ˆChebNetã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ãŠã‚Šï¼ŒPytorch Geometricã§ã¯[ChebConv](https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.ChebConv.html)ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ï¼ï¼‰

ã“ã®æ‰‹æ³•ã§ã¯ï¼Œä»¥ä¸‹ã®ãƒã‚§ãƒ“ã‚·ã‚§ãƒ•ã®å¤šé …å¼ã‚’åˆ©ç”¨ã—ã¾ã™ï¼
```math
\mathcal{T}_k(x) = 2x\mathcal{T}_{k-1}(x)-\mathcal{T}_{k-2}\\\
, \mathcal{T}_0(x)=1\\\
, \mathcal{T}_1(x)=x\\\
```
ãƒã‚§ãƒ“ã‚·ã‚§ãƒ•ã®å¤šé …å¼ã¯æ¼¸åŒ–å½¢ã§ã‚ã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ï¼

ä»¥ä¸‹ãŒChebNetã®å¼ã§ã™ï¼
$$
g_Î¸(\Lambda) = \sum_{k=0}^{K}\theta_k \mathcal{T_k(\tilde{\Lambda)}}\\
$$
$$
\tilde{\Lambda} = \frac{2}{\lambda_{max}}{\Lambda} - I
$$

ã¾ãšï¼Œ2ã¤ç›®ã®å¼ã«æ³¨ç›®ã—ã¾ã™ï¼$\lambda_{max}$ã¯ä¸€ç•ªå¤§ãã„ã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®å›ºæœ‰å€¤ã§ã™ï¼
å›ºæœ‰å€¤$\lambda_1,\lambda_2,...,\lambda_n$ã®å€¤ã®ç¯„å›²ã¯ï¼Œ$[0,\lambda_{max}]$ã§ï¼Œ $\lambda_{max}$ã§å‰²ã‚‹ã¨ï¼Œ$[0,1]$ã¨ãªã‚Šã¾ã™ï¼æ¬¡ã«2ã‚’ã‹ã‘ã‚‹ã¨$[0,2]$ã«ï¼Œãã—ã¦1ã‚’å¼•ãã¨$[-1,1]$ã¨ãªã‚Šã¾ã™ï¼
2ã¤ç›®ã®å¼ã¯å†ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¨å‘¼ã°ã‚Œï¼Œã“ã®å¼ã‚’è¡Œã†ã“ã¨ã§ï¼Œ**å›ºæœ‰å€¤ã‚’$[-1,1]$ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ï¼
å†ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã†ã“ã¨ã«ã‚ˆã£ã¦ï¼Œå­¦ç¿’ã®éš›ã«ï¼Œå€¤ãŒçˆ†ç™ºçš„ã«å¤§ãããªã£ãŸã‚Šæ¶ˆå¤±ã—ãŸã‚Šã›ãšå®‰å®šã—ã¾ã™ï¼

å¤šé …å¼ãƒ•ã‚£ãƒ«ã‚¿ã‚«ãƒ¼ãƒãƒ«ã¯ä»¥ä¸‹ã®å¼ã§ã—ãŸï¼
$$
g_Î¸(\Lambda) = \sum_{k=0}^{K-1}\theta_k\Lambda^{k}
$$


ChebNetã¯ï¼Œ$\Lambda^{k}$ã‚’$\mathcal{T_k(\tilde{\Lambda)}}$ã«ç½®ãæ›ãˆã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼

$\Lambda^{k}$ã¨$\mathcal{T_k(\tilde{\Lambda)}}$ã®å¯¾å¿œã¨ã—ã¦ã¯ï¼Œ
$\Lambda^{0}=I$ï¼Œã€€$\mathcal{T_0(\Lambda)}=I$ï¼Œ
$\Lambda^{1}=\Lambda$ï¼Œã€€$\mathcal{T_1(\Lambda)}=\tilde{\Lambda}$ï¼Œ
$\Lambda^{2}$ï¼Œã€€$\mathcal{T_2(\Lambda)}=\tilde{\Lambda}^2-I$ï¼Œ 
$\Lambda^{3}$ï¼Œã€€$\mathcal{T_3(\Lambda)}=4\tilde{\Lambda}^3-3\tilde{\Lambda}$ï¼Œ
$\Lambda^{4}$ï¼Œã€€$\mathcal{T_4(\Lambda)}=8\tilde{\Lambda}^4-8\tilde{\Lambda}^2+I$,
$...$

ã®ã‚ˆã†ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼ãã“ãã“ä¼¼ã¦ã¾ã™ã­ï¼

è¨ˆç®—é‡ã®è©±ã‚’ã™ã‚‹ãŸã‚ã«ï¼ŒChebNetã®å¼å¤‰å½¢ã—ã¾ã™ï¼
ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å…¨ä½“ã®å¼ã§è€ƒãˆã¾ã™ï¼

è¡Œåˆ—è¡¨è¨˜ã—ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®å¼
$$
f_{filtered} = Ug_Î¸(Î›)U^Tf
$$

ChebNetã®å¼
$$
g_Î¸(\Lambda) = \sum_{k=0}^{K}\theta_k \mathcal{T_k(\tilde{\Lambda)}}
$$

$$
\tilde{\Lambda} = \frac{2}{\lambda_{max}}{\Lambda} - I
$$

ã“ã‚Œã‚‰ã‚’ã¾ã¨ã‚ã‚‹ã¨ï¼Œ
```math
f_{filtered} = U  \Biggl(\sum_{k=0}^{K}\theta_k \mathcal{T_k(\tilde{\Lambda)}}\Biggr)  U^T
= \sum_{k=0}^{K}\theta_k* U\mathcal{T_k(\tilde{\Lambda)}} U^T *f
```

$\tilde{L} = \frac{2L}{Î»_{max}} âˆ’ I$ ã‚’ç”¨ã„ã‚‹ã¨ï¼Œ

```math
f_{filtered} =\sum_{k=0}^{K}\theta_k \mathcal{T_k}(\tilde{L})f
```
ã“ã“ã®å¼å¤‰å½¢ã¯ï¼Œä¸Šã®è«–æ–‡ã«è©³ã—ãè¼‰ã£ã¦ã„ã¾ã›ã‚“ãŒï¼Œ$L=U\Lambda U^T$ã€€ã‹ã‚‰ $\tilde{L}=U\tilde{\Lambda} U^T$ï¼Œ åŠã³ï¼Œ $\mathcal{T_k}(\tilde{L}) = U\mathcal{T_k(\tilde{\Lambda})} U^T$ ãŒã‚ã‹ã‚Šã¾ã™ï¼ï¼ˆè¨¼æ˜ç•¥ï¼‰


ã¾ã¨ã‚ã‚‹ã¨ï¼ŒChebNetã®è¨ˆç®—ã®æµã‚Œã¯ä»¥ä¸‹ã®1,2,3ã«ãªã‚Šã¾ã™ï¼

1.$L$ã‚’å›ºæœ‰å€¤åˆ†è§£ã—ã¦ï¼Œ$\lambda_{max}$ã‚’æ±‚ã‚ã‚‹ï¼

2.$\tilde{L} = \frac{2L}{Î»_{max}} âˆ’ I$ã‚’è¨ˆç®—ã™ã‚‹ï¼

3.$f_{filtered} =\sum_{k=0}^{K}\theta_k \mathcal{T_k}(\tilde{L})f$ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ï¼


ã§ã¯ï¼Œ**ãªãœãƒã‚§ãƒ“ã‚·ã‚§ãƒ•ã®å¤šé …å¼ã§è¿‘ä¼¼ã™ã‚‹ã“ã¨ã§è¨ˆç®—é‡ã‚’å‰Šæ¸›ã§ãã‚‹ã‹**ã‚’è€ƒãˆã¾ã™ï¼
3ã®å¼ã‚’$\Sigma$ã‚’ä½¿ã‚ãšã«æ›¸ãã¾ã™ï¼
$$
f_{filtered} =\sum_{k=0}^{K}\theta_k \mathcal{T_k}(\tilde{L})f = \theta_0 \mathcal{T_0}(\tilde{L})f + \theta_1\mathcal{T_1}(\tilde{L})f + \theta_2 \mathcal{T_2}(\tilde{L})f + ... + \theta_{K-1} \mathcal{T_{K-1}}(\tilde{L})f
$$

ãƒã‚§ãƒ“ã‚·ã‚§ãƒ•ã®å¤šé …å¼ã®å®šç¾©å¼ã®$x$ã«ï¼Œ$\tilde{L}$ã‚’ä»£å…¥ã™ã‚‹ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
```math
\mathcal{T}_k(\tilde{L}) = 2\tilde{L}\mathcal{T}_{k-1}(\tilde{L})-\mathcal{T}_{k-2},\ \mathcal{T}_0(\tilde{L})=I\\\
, \mathcal{T}_1(\tilde{L})=\tilde{L}\\\
```

ã“ã®é–¢ä¿‚ã‚’ä½¿ç”¨ã™ã‚‹ã¨ï¼Œ**è¨ˆç®—çµæœã‚’å†åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ï¼ ã“ã‚Œã«ã‚ˆã£ã¦ï¼Œè¡Œåˆ—è¨ˆç®—ãŒ$O(K|\mathcal{E}|)$ã«ãªã‚Šã¾ã™ï¼
æ³¨æ„ï¼šsparse matrixã‚’ä½¿ç”¨ã™ã‚‹ã¨ï¼Œè¡Œåˆ—ã®ç©ãŒ$O(|\mathcal{E}|)$ãªã‚Šã¾ã™ï¼

ç°¡å˜ã«æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸ ï¼tilde_LãŒ$\tilde{L}$ã‚’è¡¨ã—ã¾ã™ï¼
```python
# æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰
def ChebNet(K, tilde_L, Î¸, f):

    # åˆæœŸåŒ–
    f_filetered = 0
    
    # T_k_2ã¯T_k-2ã‚’ï¼Œ T_k_1ã¯T_k-1ã‚’è¡¨ã™ï¼
    T_k_2 = Î¸[0] * I @ f # å˜ä½è¡Œåˆ—ï¼Œ T_0
    T_k_1 = Î¸[1] * tilde_L @ f # T_1

    # k = 2,3,...K-1
    for k in range(2,K):
        T_k = 2 * tilde_L @ T_k_1 - T_k_2 # æ¼¸åŒ–å¼
        f_filterd += Î¸[k] * T_k @ f
    
        # æ›´æ–°
        T_k_2 = T_k_1
        T_k_1 = T_k

    return f_fileterd
```

ã‚ˆã£ã¦ï¼ŒChebNetã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®è¨ˆç®—é‡ã¯ï¼Œ
ãƒ»ã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³$L$ã®å›ºæœ‰å€¤åˆ†è§£ï¼š$O(N^3)$ã€€ãŸã ã—ï¼Œã“ã®è¨ˆç®—ã¯1å›ã ã‘
ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®è¡Œåˆ—è¨ˆç®—...$O(K|\mathcal{E}|)$ ã‚¨ãƒãƒƒã‚¯ã”ã¨ã«è¨ˆç®—ã™ã‚‹


# 5. GCN
ã‚ˆã†ã‚„ãGCNã®æ•°å¼ã«å…¥ã£ã¦ã„ãã¾ã™ï¼

# 5.1 GCNã®ã‚¢ã‚¤ãƒ‡ã‚¢
ChebNetã®å¼ã‚’å†æ²ã—ã¾ã™ï¼

$$
\tilde{L} = \frac{2L}{Î»_{max}} âˆ’ I
$$

$$
f_{filtered} =\sum_{k=0}^{K}\theta_k \mathcal{T_k}(\tilde{L})f
$$

GCNã§ã¯ï¼Œã“ã‚Œã‚‰ã®å¼ã‚’ã¨ã«ã‹ãç°¡ç•¥åŒ–ã—ã¦ã„ãã¾ã™ï¼

ChebNetã®å¼ã«ãŠã„ã¦ï¼Œ
ã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³$L$ã‚’æ­£è¦åŒ–ã‚°ãƒ©ãƒ•ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³$\mathcal{L}$ã«å¤‰æ›´ã—ï¼Œ
<font color="DarkOrange">**$Î»_{max}=2$**</font>ï¼Œ <font color="DarkOrange">**$K=1$**</font>ã¨ã—ã¾ã™ï¼
$Î»_{max}=2$ã¨æ±ºã‚ã¦ã—ã¾ã†ã“ã¨ã§ï¼Œ**$O(n^3)$ã®å›ºæœ‰å€¤åˆ†è§£ã‚’ã›ãšã«æ¸ˆã¿**ï¼Œ$K=1$ã¨ã™ã‚‹ã“ã¨ã§ï¼Œ**è‡ªåˆ†è‡ªèº«ã¨éš£æ¥ãƒãƒ¼ãƒ‰ã—ã‹è¦‹ãªã„**ã‚ˆã†ã«ã—ã¾ã™ï¼

$$
\tilde{\mathcal{L}} = \mathcal{L} âˆ’ I = D^{-\frac{1}{2}}AD^{-\frac{1}{2}}
$$
ãƒ¡ãƒ¢ï¼šã“ã‚Œã¯ $\mathcal{L}= I - D^{-\frac{1}{2}}AD^{-\frac{1}{2}}$ã‚’å¤‰å½¢ã™ã‚‹ã“ã¨ã§å¾—ã‚‰ã‚Œã¾ã™ï¼


```math
\displaylines{
f_{filtered} = \sum_{k=0}^{2}\theta_k \mathcal{T_k}(\tilde{\mathcal{L}})f \\
= \theta_0 \mathcal{T_0}(\tilde{\mathcal{L}})f + \theta_1 \mathcal{T_1}(\tilde{\mathcal{L}})f  \\
= \theta_0 I f + \theta_1 \tilde{L}f \\
= (\theta_0I + \theta_1 \tilde{\mathcal{L}})f \\
= (\theta_0I - \theta_1 D^{-\frac{1}{2}}AD^{-\frac{1}{2}})f
}
```

ã•ã‚‰ã«ï¼Œ
<font color="DarkOrange"> **$\theta = \theta_0 = -\theta_1 $**</font>ã¨ã—ã¾ã™ï¼ã‚‚ã£ã¨ç°¡ç•¥åŒ–ã—ã¾ã™ï¼
ãã†ã™ã‚‹ã¨ï¼Œ
$$
f_{filtered} = \theta(I + D^{-\frac{1}{2}}AD^{-\frac{1}{2}})f
$$
ã¨ãªã‚Šã¾ã™ï¼

ã—ã‹ã—ï¼Œ $I + D^{-\frac{1}{2}}AD^{-\frac{1}{2}}$ ã¯ã“ã®ã¾ã¾ã§ã¯å›ºæœ‰å€¤ãŒ$[0,2]$ã§æ•°å€¤çš„ã«ä¸å®‰å®šã§ï¼Œå‹¾é…ãŒçˆ†ç™ºã—ãŸã‚Šæ¶ˆå¤±ã™ã‚‹æã‚ŒãŒã‚ã‚‹ã®ã§ï¼Œä»¥ä¸‹ã®ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¾ã™ï¼

```math
\displaylines{
I + D^{-\frac{1}{2}}AD^{-\frac{1}{2}} â†’ \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} \\
\tilde{A} = A + I, \tilde{D}ã¯\tilde{A}ã®æ¬¡æ•°è¡Œåˆ—
}
```

ä»¥ä¸Šã‚ˆã‚Šï¼Œ

$$
f_{filtered} = \theta \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} f
$$

ã¨ãªã‚Šã¾ã™ï¼

# 5.2 ã‚°ãƒ©ãƒ•ä¿¡å·ã®ä¸€èˆ¬åŒ–

ã‚°ãƒ©ãƒ•ä¿¡å·ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ãŸã®ã§ï¼Œã“ã‚Œã¾ã§$f$ åŠã³ï¼Œ $f_{filtered}$ã¨ã„ã†è¡¨è¨˜ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸï¼
ã‚°ãƒ©ãƒ•ä¿¡å·ã¯å„ãƒãƒ¼ãƒ‰ãŒå€¤ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ï¼‰ã‚’æŒã£ã¦ãŠã‚Šï¼Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ã“ã¨ã§ï¼Œæ–°ãŸãªå€¤ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ï¼‰ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸï¼

ã‚‚ã£ã¨ä¸€èˆ¬ã®çŠ¶æ³ã‚’è€ƒãˆã¾ã—ã‚‡ã†ï¼ã‚°ãƒ©ãƒ•ã®å„ãƒãƒ¼ãƒ‰ãŒCæ¬¡å…ƒã®ç‰¹å¾´é‡ã‚’æŒã£ã¦ã„ã‚‹ã¨ã—ã¾ã™ï¼
ã“ã“ã‹ã‚‰ã¯ï¼Œ$f$ã§ã¯ãªãï¼Œ$X$ã‚’ä½¿ç”¨ã—ã¾ã™ï¼

å…ˆã»ã©ã®å¼ã‚’æ›¸ãæ›ãˆã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

$X_i, X'_i$ã¯å…±ã«$N$æ¬¡å…ƒã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ï¼
$$
X'_i = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} X_i
$$

ã“ã®å¼ã«ã‚ˆã£ã¦ï¼Œç‰¹å¾´é‡ã‚’$X_i$ã‹ã‚‰$X'_i$ã¸æ›´æ–°ã§ãã¾ã™ï¼

æ›´æ–°ã—ã¦å¾—ã‚‰ã‚ŒãŸï¼Œä»¥ä¸‹ã®Cæ¬¡å…ƒã®ç‰¹å¾´é‡ã‹ã‚‰ï¼Œæ–°ãŸãªFæ¬¡å…ƒã®ç‰¹å¾´é‡ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã™ï¼

```math
(X'_0, X'_1, ...  X'_{C-1})
```


å…·ä½“ä¾‹ã§è€ƒãˆã¾ã™ï¼

ä¸‹ã®å›³ã§ã¯ï¼Œå„ãƒãƒ¼ãƒ‰ãŒèµ¤ï¼Œç·‘ï¼Œé’ã®3æ¬¡å…ƒã®ç‰¹å¾´é‡ã‚’æŒã¡ã¾ã™ï¼
ãƒãƒ¼ãƒ‰ã”ã¨ã«ç‰¹å¾´ã‚’ã¾ã¨ã‚ãŸãƒ™ã‚¯ãƒˆãƒ«$X_{red},X_{green}, X_{blue}$ã‚’ç”¨æ„ã—ã¾ã™ï¼
ãƒãƒ¼ãƒ‰æ•°ãŒ5ãªã®ã§ï¼Œå„ãƒ™ã‚¯ãƒˆãƒ«ã¯5æ¬¡å…ƒã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã«ãªã‚Šã¾ã™ï¼

ã“ã‚“ãªæ„Ÿã˜ã§ã™ï¼
$$
X = (X_{red},X_{green},X_{blue})
$$
```math
\begin{eqnarray}
X_{red}=
\left(
\begin{array}{cccc}
X_{0,red} \\\
X_{1,red}  \\\
X_{2,red}  \\\
X_{3,red}  \\\
X_{4,red}  \\\
\end{array}
\right)
,
X_{green}=
\left(
\begin{array}{cccc}
X_{0,green} \\\
X_{1,green}  \\\
X_{2,green}  \\\
X_{3,green}  \\\
X_{4,green}  \\\
\end{array}
\right)
,
X_{blue}=
\left(
\begin{array}{cccc}
X_{0,blue} \\\
X_{1,blue}  \\\
X_{2,blue}  \\\
X_{3,blue}  \\\
X_{4,blue}  \\\
\end{array}
\right)

\end{eqnarray}
```

<img width="500" alt="GCN1.png" src=https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3583007/a2b1c154-4a21-40b6-47f7-e3c7fa7cda81.png>



ã“ã®ç‰¹å¾´é‡ã‚’æ›´æ–°ã—ã¾ã™ï¼
$ X_{red}' =  \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} X_{red}$
$ X_{red}' =  \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} X_{red}$
$ X_{red}' =  \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}} X_{red}$

æ›´æ–°ã™ã‚‹ã“ã¨ã§ï¼Œä»¥ä¸‹ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã—ã¾ã™ï¼
```math
X'_{red}=
\begin{eqnarray}
\left(
\begin{array}{cccc}
X'_{0,red} \\\
X'_{1,red}  \\\
X'_{2,red}  \\\
X'_{3,red}  \\\
X'_{4,red}  \\\
\end{array}
\right)
,
X'_{green}=
\left(
\begin{array}{cccc}
X'_{0,green} \\\
X'_{1,green}  \\\
X'_{2,green}  \\\
X'_{3,green}  \\\
X'_{4,green}  \\\
\end{array}
\right)
,
X'_{blue}=
\left(
\begin{array}{cccc}
X'_{0,blue} \\\
X'_{1,blue}  \\\
X'_{2,blue}  \\\
X'_{3,blue}  \\\
X'_{4,blue}  \\\
\end{array}
\right)

\end{eqnarray}
```

ã“ã‚Œã‚‰ã®ç‰¹å¾´é‡ã‚’ç·šå‹çµåˆã§çµ„ã¿åˆã‚ã›ã¦æ–°ãŸãªç‰¹å¾´é‡ã‚’ä½œã‚Šã¾ã™ï¼
ä¾‹ãˆã°ï¼Œã“ã‚“ãªæ„Ÿã˜ã§ä½œã‚Œã¾ã™ï¼
```math
X_{new} =  0.7 \times X'_{red} + 0.9 \times X'_{green} + (-0.4) \times X'_{blue} 
```

æ–°ãŸãªç‰¹å¾´é‡ã‚’10å€‹ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼ã©ã®ã‚ˆã†ã«ç‰¹å¾´é‡ã‚’ä½œã‚‹ã‹ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãªã‚Šã¾ã™ï¼
```math
\displaylines{
Z_0 = \theta_{0,0} \times X'_{red} + \theta_{1,0} \times X'_{green} + \theta_{2,0} \times X'_{blue} \\
Z_1 = \theta_{0,1} \times X'_{red} + \theta_{1,1} \times X'_{green} + \theta_{2,1} \times X'_{blue} \\
\vdots \\
Z_9 = \theta_{0,9} \times X'_{red} + \theta_{1,9} \times X'_{green} + \theta_{2,9} \times X'_{blue} \\
}
```

ã“ã‚Œã¯è¡Œåˆ—ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã¾ã™ï¼
```math
\displaylines{
(Z_0,Z_1,...,Z_9) = (X'_{red}, X'_{green}, X'_{blue})
\begin{eqnarray}
\left(
\begin{array}{cccc}
\theta_{0,0} & \theta_{0,1}  & \ldots & \theta_{0,9}  \\\
\theta_{1,0} & \theta_{1,1}  & \ldots & \theta_{1,9}  \\\
\theta_{2,0} & \theta_{2,1}  & \ldots & \theta_{2,9}  
\end{array}
\right)
\end{eqnarray}
}
```

ã“ã“ã§ï¼Œ
```math
\displaylines{
Z = (Z_0,Z_1,...,Z_9)\\\
X' = (X'_{red}, X'_{green}, X'_{blue})\\\
\begin{eqnarray}
\Theta = 
\left(
\begin{array}{cccc}
\theta_{0,0} & \theta_{0,1}  & \ldots & \theta_{0,9}  \\\
\theta_{1,0} & \theta_{1,1}  & \ldots & \theta_{1,9}  \\\
\theta_{2,0} & \theta_{2,1}  & \ldots & \theta_{2,9}  
\end{array}
\right)

\end{eqnarray}
}
```

ã¨ç½®ãã¨ï¼Œ

```math
Z = X'\Theta
```

ã¨æ›¸ã‘ã¾ã™ï¼

ã•ã‚‰ã«ï¼Œ
```math
\displaylines{
X' = (X'_{red}, X'_{green}, X'_{blue}) \\\
   = (\tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X_{red}, \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X_{green}, \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X_{blue})\\\
   = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}(X_{red}, X_{green}, X_{blue})\\
   = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X
}
```
ã§ã‚ã‚‹ã®ã§ï¼Œ

```math
Z = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X\Theta
```

ã¾ã¨ã‚ã‚‹ã¨ï¼Œ
3æ¬¡å…ƒã®ç‰¹å¾´é‡$X=(X_{red}, X_{green}, X_{blue})$ã‚’ï¼Œ$\tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}$ã¨ã„ã†å¼ã§æ›´æ–°ã—ï¼Œ
ãã“ã«ï¼Œ$3\times 10$ã®é‡ã¿è¡Œåˆ—$\Theta$ã‚’ã‹ã‘ã‚‹ã“ã¨ã§ï¼Œ3æ¬¡å…ƒã®ç‰¹å¾´é‡ã‚’è‰²ã€…çµ„ã¿åˆã‚ã›ã¦ä½œã£ãŸ10æ¬¡å…ƒã®ç‰¹å¾´é‡$Z=(Z_0,Z_1,...,Z_9)$ãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã§ã™ï¼

ã‚‚ã£ã¨ä¸€èˆ¬ã«ï¼Œæ›´æ–°å‰ã®ç‰¹å¾´é‡ã‚’Cæ¬¡å…ƒï¼Œæ›´æ–°å¾Œã®ç‰¹å¾´é‡ã‚’Fæ¬¡å…ƒã¨ã™ã‚‹ã“ã¨ãŒã§ãï¼Œ
$X$ã¯$N\times C$ï¼Œ $\Theta$ã¯$C\times F$, $Z$ã¯$N\times F$ ã®è¡Œåˆ—ã¨ãªã‚Šã¾ã™ï¼

ã“ã‚Œã«ã¦ï¼ŒGCNã®æ•°å¼ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼

# 5.3 å±¤ã®è¿½åŠ 

GCNã®æ›´æ–°å¼
```math
Z = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X\Theta
```

GCNã§ã¯ï¼ŒChebNetã«ãŠã„ã¦ï¼Œ$K=1$ã¨ã—ã¦ã„ã¾ã—ãŸï¼
ã“ã®$K$ã¯ï¼Œã©ã“ã¾ã§ã®è¿‘å‚ã®æƒ…å ±ã‚’ä½¿ç”¨ã™ã‚‹ã‹ï¼Œã¨ã„ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã®ã§ï¼Œ
$K=1$ã¨ã„ã†ã®ã¯**è‡ªåˆ†è‡ªèº«ã¨éš£ã®ãƒãƒ¼ãƒ‰ã®æƒ…å ±ã—ã‹æ´»ç”¨ã—ã¦ã„ãªã„**ã¨ã„ã†ã“ã¨ã§ã™ï¼

ã‚‚ã†å°‘ã—ï¼Œå¤šãã®è¿‘å‚ã‚’æ‹¾ã„ãŸã„ã¨ã“ã‚ã§ã™ï¼
GCNã®å±¤ã‚’é‡ã­ã‚‹ã“ã¨ã§ã“ã‚Œã‚’å®Ÿç¾ã§ãã¾ã™ï¼æ´»æ€§åŒ–é–¢æ•°ã‚’$\sigma$ã¨ã—ã¦ï¼Œ

```math
\displaylines{
Z_1 = \sigma (\tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}X\Theta)\\
Z_2 = \tilde{D}^{-\frac{1}{2}}\tilde{A}\tilde{D}^{-\frac{1}{2}}Z_1\Theta \\
}
```
ã“ã®ã‚ˆã†ã«å±¤ã‚’é‡ã­ã‚‹ã¨ï¼Œ $Z_1$ã§è‡ªåˆ†è‡ªèº«ã¨1æ¬¡è¿‘å‚ã®æƒ…å ±ã‚’æ‰ãˆï¼Œ$Z_2$ã§è‡ªåˆ†è‡ªèº«ã¨1æ¬¡è¿‘å‚ï¼Œ2æ¬¡è¿‘å‚ã®æƒ…å ±ã‚’æ‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

å¿…è¦ã«å¿œã˜ã¦ï¼Œå±¤ã®æ•°ã‚’å¤‰æ›´ã—ãŸã‚Šï¼Œ$\sigma$ã‚’å±¤ã”ã¨ã«å¤‰æ›´ã—ãŸã‚Šã¨,**å±¤ã«åˆ†ã‘ã‚‹ã“ã¨ã§ï¼ŒæŸ”è»Ÿãªè¨­è¨ˆãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼**


# 6. çµ‚ã‚ã‚Šã«

ã‹ãªã‚Šé•·ã„è¨˜äº‹ã¨ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸğŸ˜“

GCNã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ï¼Œã‚°ãƒ©ãƒ•ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã¨ChebNetã‹ã‚‰å­¦ã³ã¾ã—ãŸï¼

å°‘ã—ã§ã‚‚å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ï¼

ä½™è«‡ï¼šGCNã¯ã‚°ãƒ©ãƒ•ä¿¡å·å‡¦ç†ãŒãƒ™ãƒ¼ã‚¹ã®æ‰‹æ³•ãªã®ã§Spectralãªæ‰‹æ³•ã«è©²å½“ã—ã¾ã™ï¼
ã€€ã€€ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã›ãšï¼Œè¿‘å‚ãƒãƒ¼ãƒ‰ã®ç‰¹å¾´é‡ã‚’æ´»ç”¨ã™ã‚‹æ‰‹æ³•ã¯Spatialãªæ‰‹æ³•ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ï¼GraphSAGEãªã©ã®Spatialãªæ‰‹æ³•ã®æ–¹ãŒç›´æ„Ÿçš„ã§ã‚ã‹ã‚Šã‚„ã™ã„ã®ã§ï¼ŒGCNã‚’å­¦ã‚“ã å¾Œã ã¨ï¼Œç°¡å˜ã«æ€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼



# ãŠã™ã™ã‚ã®è¨˜äº‹
[ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯(GNN)å¾¹åº•è§£èª¬ï¼ç”¨é€”ã¨ä»•çµ„ã¿ã‹ã‚‰PyGã§ã®å®Ÿè£…ã¾ã§](https://zenn.dev/dena/articles/83c2daff760f5d#%E5%89%8D%E7%9F%A5%E8%AD%98%EF%BC%9A%E3%82%B0%E3%83%A9%E3%83%95%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B%EF%BC%88graph-fourier-transform%EF%BC%89)...æ—¥æœ¬èªã§ã‹ãªã‚Šè©³ã—ãGNNãŒè§£èª¬ã•ã‚Œã¦ã„ã¦ãŠã™ã™ã‚ï¼

[PyTorchã§å­¦ã¶Graph Convolutional Networks](https://qiita.com/omiita/items/429136c2f4e228d745ed)...PyTorchã«ã‚ˆã‚‹å®Ÿè£…ãŒå­¦ã¹ã‚‹ï¼

